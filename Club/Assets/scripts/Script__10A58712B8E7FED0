var type;$('.panel-options [bd]').click(function () {loadDynamic($(this).attr('bd')); });function loadDynamic(_type) {type = _type;pf(1);}function pf(page){ $.get('/DynamicList?page=' + page, { uid:uid, type: type }, function (rt) {$('.tab-content').html(rt); $('.panel-options [bd='+type+']').parent().addClass('active').siblings().removeClass('active');});}$(function(){$('.panel-options [bd]:first').click();});
//关注和取消关注$("#focusfan").click(function () {var that = $(this);var fuid = that.data("fuid");var uid = that.data("myid");that.attr('disabled', 'disabled');if (uid == "0") {layer.msg("您还没有登录", { icon: 2 });}else {loadData("FocusFans", { touid: fuid }, function (rt) {if (rt == "okfocus") {that.html("<i class='fa fa-heart'></i>取消关注TA");that.removeAttr('disabled');}else if (rt == "okcancle") {that.html("<i class='fa fa-heart'></i>关注TA");that.removeAttr('disabled');}else {layer.msg(rt, { icon: 2 });reload();}});}});
//发送站内信$(".do-whisper").click(function () {var that = this;var uid = $(that).data("myid");$(that).attr('disabled', 'disabled');if (uid == "0") {layer.msg("您还没有登录", { icon: 2 });return;}layer.open({type: 1,area: ['300px', 'auto'],title: false,closeBtn: true,shadeClose: false,content: '<div class="form-group" style="padding: 15px; text-align: center;">' +'<div class="col-sm-12">' +'<textarea id="whisper-msg" style="resize:none" class="form-control" placeholder="请输入私信内容，不超过200字" rows="5"></textarea>' +'<a onclick="smsg(this)" class="deliver-whisper btn btn-danger btn-sm btn-block" data-at_uid="' + $(that).data('at_uid') + '" style="margin: 5px 0;"><i class="fa fa-envelope"></i> 发送私信</a>' +'<small class="help-block m-b-none">私信将同时通过微信发给对方</small>' +'<small class="help-block m-b-none">本次私信将消耗 <b>' + $(that).data('whisper') + '</b>个金币</small>' +'</div>' +'</div>'});});
function smsg(obj) {var content = $("#whisper-msg").val();if (content.length < 1) {layer.msg('私信内容应不少于一个字符', { icon: 2 });return;}else {var that = obj;$(that).attr('disabled', 'disabled');$(that).html('<i class="fa fa-spinner fa-spin"></i> 发送中...');loadData("SendBbsMsg", { msg: content, touid: $(that).data('at_uid') }, function (rt) {if (rt == "ok") {layer.closeAll();layer.msg("消息已经发送成功", { icon: 1 });}else {layer.closeAll();layer.msg(rt, { icon: 2 });}$(that).removeAttr('disabled');});}};
$(".doRecharge").on('click', function (event) {layer.prompt({title: '请输入充值金额（1元 = 100金币）',formType: 0}, function (money) {money = $.trim(money);if (money > 0 && money <= 1000) {money *= 100;
p.pay({value: money, param: 'BBS', success: 'http://bbs.bangke.com/User?paysuccess=true',fail: 'http://bbs.bangke.com/User?paysuccess=false',callBack: function () {layer.alert('金币充值成功! ',{icon:1}, function(){ window.location.href = '/Scores' });},});} else {layer.msg('单次充值人民币范围 1~1000', { icon: 2 });}});
$('.layui-layer-input').attr('type', 'number').attr('placeholder', '请输入人民币整数金额');
$(".recharge-input").keyup(function () {var c = $(this);if (/[^\d]/.test(c.val())) {var temp_amount = c.val().replace(/[^\d]/g, '');$(this).val(temp_amount);}});});
